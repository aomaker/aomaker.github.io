---
title: ğŸš€å¤šä»»åŠ¡
author: Ancient One
date: 2022-07-10
category: Jekyll
layout: post
---

`aomaker` æä¾›äº†å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹ä¸¤ç§æ–¹å¼æ¥åŠ é€Ÿç”¨ä¾‹è¿è¡Œé€Ÿåº¦ï¼Œæä¾›äº†ä¸‰ç§ç²’åº¦æ¥åˆç†æ§åˆ¶çº¿ç¨‹/è¿›ç¨‹workerï¼Œæ­¤å¤–ï¼Œå¤šçº¿ç¨‹æ¨¡å¼ä¸‹ï¼Œå¯¹`allure` æŠ¥å‘Šä¹Ÿåšäº†å®Œç¾å…¼å®¹ã€‚

![jRLzDS.md.png](https://s1.ax1x.com/2022/07/13/jRLzDS.md.png)

# å¤šçº¿ç¨‹ï¼ˆæ¨èï¼‰

##### å¯åŠ¨æ–¹å¼

`aomaker`æä¾›äº†ä¸¤ç§å¯åŠ¨å¤šçº¿ç¨‹ï¼š**CLI**å’Œ**run.py**

1. cli

```
multi-run:
--mp, --multi-process
specifies a multi-process running mode.
--mt, --multi-thread  specifies a multi-thread running mode.
--dist-suite DIST_SUITE
specifies a dist mode for per worker.
--dist-file DIST_FILE
specifies a dist mode for per worker.
--dist-mark DIST_MARK [DIST_MARK ...]
specifies a dist mode for per worker.

```

å‘½ä»¤è¡Œè¾“å…¥ï¼š`arun --mt --dist-xxx xxx`æˆ–è€…`aomaker run --mt --dist-xxx`

2. run.py

_run.py_

```python
from login import Login

from aomaker.runner import threads_run

if __name__ == '__main__':
    threads_run(['-m ehpc','-m hpc'], login=Login())
```

##### åˆ†é…æ¨¡å¼

ä¸ºäº†æ›´åŠ ç²¾ç»†å’Œåˆç†çš„å»åˆ†é…ä»»åŠ¡ç»™å­çº¿ç¨‹ï¼Œ`aomaker`æä¾›äº†ä¸‰ç§åˆ†é…æ¨¡å¼ï¼Œé¢—ç²’åº¦ç”±ç»†åˆ°ç²—åˆ†åˆ«æ˜¯ï¼š

1. æŒ‰æ ‡è®°åˆ†é…

å³æŒ‰ç…§`pytest`æä¾›çš„`mark`åŠŸèƒ½æ¥åˆ†é…ä»»åŠ¡ç»™å­çº¿ç¨‹ï¼Œæ¯”å¦‚è¯´ä½ å¸Œæœ›å°†æ ‡è®°ä¸º`demo1`ã€`demo2`ã€`demo3`çš„ä¸‰ç»„caseåˆ†é…ç»™ä¸‰ä¸ªä¸åŒå­çº¿ç¨‹å»è·‘ï¼Œé‚£ä¹ˆä½ éœ€è¦åšçš„å°±æ˜¯ï¼šæå‰ç»™ç”¨ä¾‹æ‰“ä¸Šå¯¹åº”`mark`ï¼Œç„¶åï¼š

- cliï¼š`arun --mt --dist-mark demo1 demo2 demo3`
- run.py: 

_run.py_

```python
from login import Login

from aomaker.runner import threads_run

if __name__ == '__main__':
    # æ³¨æ„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„æ˜¯åˆ—è¡¨
    threads_run(['-m demo1','-m demo2','-m demo3'], login=Login())
```

è¿™æ ·å¯åŠ¨åï¼Œä¼šå¼€å¯ä¸‰ä¸ªå­çº¿ç¨‹ï¼Œå»åˆ†åˆ«æ‰§è¡Œä¸‰ç»„caseã€‚

**æ³¨æ„ï¼š**

**1.æ¯ç»„markä¸‹çš„caseï¼Œä¸€å®šè¦ä¿è¯æ˜¯ç‹¬ç«‹çš„ï¼**

**2.æä¾›å¤šå°‘ä¸ªmarkï¼Œå°±å¼€å¯å¤šå°‘ä¸ªçº¿ç¨‹**

2. æŒ‰æµ‹è¯•æ¨¡å—åˆ†é…

å³æŒ‰ç…§æµ‹è¯•æ–‡ä»¶æ¥åˆ†é…ä»»åŠ¡ç»™å­çº¿ç¨‹ï¼Œæ¯”å¦‚åœ¨`testcases\test_api`ç›®å½•ä¸‹æœ‰`test_demo1.py`ã€`test_demo2.py`ã€`test_demo3.py`ä¸‰ä¸ªæµ‹è¯•æ¨¡å—ï¼Œä½ å¸Œæœ›è¿™ä¸‰ä¸ªæ¨¡å—ä¸‹çš„æµ‹è¯•caseåˆ†åˆ«ç”±ä¸‰ä¸ªå­çº¿ç¨‹æ¥ç®¡æ‰§è¡Œï¼Œé‚£ä¹ˆåªéœ€è¦ï¼š

- cliï¼š`arun --mt --dist-file testcases\test_api`ï¼Œå³å‘Šè¯‰`aomaker`æµ‹è¯•æ–‡ä»¶æ‰€åœ¨ç›®å½•æ—¢å¯
- run.py: 

_run.py_

```python
from login import Login

from aomaker.runner import threads_run

if __name__ == '__main__':
    # æ³¨æ„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„æ˜¯keyåä¸ºpathçš„å­—å…¸
    threads_run({"path":"testcases/test_api"}, login=Login())
```

**æ³¨æ„ï¼š**

**1.æ¯ä¸ªæµ‹è¯•æ¨¡å—ä¸‹çš„caseï¼Œä¸€å®šè¦ä¿è¯æ˜¯ç‹¬ç«‹çš„ï¼**

**2.æŒ‡å®šç›®å½•ä¸‹æœ‰å¤šå°‘ä¸ªæµ‹è¯•æ¨¡å—ï¼Œå°±å¼€å¯å¤šå°‘ä¸ªçº¿ç¨‹**

3. æŒ‰æµ‹è¯•å¥—ä»¶åˆ†é…

å³æŒ‰ç…§æµ‹è¯•ç›®å½•æ¥åˆ†é…ä»»åŠ¡ç»™å­çº¿ç¨‹ï¼Œæ¯”å¦‚åœ¨`testcases\test_scenario`ç›®å½•ä¸‹ï¼Œæœ‰`test_scenario1`ã€`test_scenario2`ã€`test_scenario3`ç­‰ä¸‰ä¸ªæµ‹è¯•ç›®å½•ï¼Œæ¯ä¸ªç›®å½•ä¸‹è¿˜æœ‰è‹¥å¹²æµ‹è¯•æ¨¡å—ï¼Œä½ å¸Œæœ›è¿™ä¸‰ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æµ‹è¯•caseåˆ†åˆ«ç”±ä¸‰ä¸ªå­çº¿ç¨‹æ¥ç®¡æ‰§è¡Œï¼Œé‚£ä¹ˆåªéœ€è¦ï¼š

- cliï¼š`arun --mt --dist-suite testcases\test_scenario`ï¼Œå³å‘Šè¯‰`aomaker`æµ‹è¯•å¥—ä»¶æ‰€åœ¨ç›®å½•æ—¢å¯
- run.py: 

_run.py_

```python
from login import Login

from aomaker.runner import threads_run

if __name__ == '__main__':
    # æ³¨æ„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„æ˜¯å­—ç¬¦ä¸²
    threads_run("testcases/test_scenario", login=Login())
```

**æ³¨æ„ï¼š**

**1.æ¯ä¸ªæµ‹è¯•æ¨¡å—ä¸‹çš„caseï¼Œä¸€å®šè¦ä¿è¯æ˜¯ç‹¬ç«‹çš„ï¼**

**2.æŒ‡å®šç›®å½•ä¸‹æœ‰å¤šå°‘ä¸ªæµ‹è¯•å¥—ä»¶ï¼Œå°±å¼€å¯å¤šå°‘ä¸ªçº¿ç¨‹**

# å¤šè¿›ç¨‹

`aomaker`ç›®å‰æš‚æ—¶ä¸æ”¯æŒåœ¨windowsä¸Šåˆ›å»ºå¤šè¿›ç¨‹ï¼Œlinuxæ˜¯å®Œç¾æ”¯æŒçš„ã€‚

##### å¯åŠ¨æ–¹å¼

`aomaker`åŒæ ·æä¾›äº†ä¸¤ç§å¯åŠ¨å¤šè¿›ç¨‹ï¼š**CLI**å’Œ**run.py**

1. cli

```
multi-run:
--mp, --multi-process
specifies a multi-process running mode.
--mt, --multi-thread  specifies a multi-thread running mode.
--dist-suite DIST_SUITE
specifies a dist mode for per worker.
--dist-file DIST_FILE
specifies a dist mode for per worker.
--dist-mark DIST_MARK [DIST_MARK ...]
specifies a dist mode for per worker.

```

å‘½ä»¤è¡Œè¾“å…¥ï¼š`arun --mp --dist-xxx xxx`æˆ–è€…`aomaker run --mp --dist-xxx`

2. run.py

_run.py_

```python
from login import Login

from aomaker.runner import processes_run

if __name__ == '__main__':
    processes_run(['-m ehpc','-m hpc'], login=Login())
```

##### åˆ†é…æ¨¡å¼

åˆ†é…æ¨¡å¼å’Œå¤šçº¿ç¨‹æ˜¯ä¸€æ ·çš„ï¼ŒåŒºåˆ«æ˜¯ä»»åŠ¡æ˜¯åˆ†é…ç»™å­è¿›ç¨‹ï¼Œè€Œä¸æ˜¯å­çº¿ç¨‹ï¼Œå…·ä½“åˆ†é…æ¨¡å¼è¯·å‚è€ƒå¤šçº¿ç¨‹ã€‚
