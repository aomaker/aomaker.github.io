---
title: ğŸ‘½async_apiè£…é¥°å™¨ç”¨æ³•
author: Ancient One
date: 2022-05-24
category: Jekyll
layout: post
---

# å½“æ¥å£æ˜¯å¼‚æ­¥æ¥å£ï¼Œæ€ä¹ˆåšåˆ¤æ–­å¼‚æ­¥ç»“æœï¼Ÿ

`aomaker`æä¾›äº†`@async_api`æ¥æ ‡è®°å¼‚æ­¥æ¥å£ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```python
from aomaker.base.base_api import BaseApi
from aomaker.aomaker import dependence, async_api

from apis.cluster import cluster

from utils import wait_job


class Job(BaseApi):

    @async_api(wait_job, 'hpcjob_uuid')
    @dependence(cluster.get_cluster_list, 'hpc_cluster_id', cluster_type='hpc')
    def submit_hpc_job(self, test_data):
        ...
        return resp
```

**ä½¿ç”¨æ­¥éª¤ï¼š**

1. `from aomaker.aomaker import async_api`å¯¼å…¥`@async_api`è£…é¥°å™¨
1. `@async_api`è£…é¥°å™¨æ¥æ”¶ä¸¤ä¸ªå¿…ä¼ å‚æ•°ï¼š
   1. ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè‡ªå·±ç¼–å†™çš„è½®è¯¢å‡½æ•°
   1. ç¬¬äºŒä¸ªå‚æ•°ï¼Œä»ç›®æ ‡æ¥å£çš„å“åº”ä¸­æ ¹æ®jsonpathè¡¨è¾¾å¼æå–å¼‚æ­¥ä»»åŠ¡id
   1. éå¿…å¡«å‚æ•°ï¼Œ`jsonpath`è¡¨è¾¾å¼æå–å‡ºçš„å€¼æ˜¯`list`ï¼Œå¯ä»¥æ ¹æ®è‡ªèº«éœ€æ±‚æŒ‡æ˜éœ€è¦æå–å“ªä¸ªï¼Œé»˜è®¤å€¼ä¸º`0`

å½“ä¸€ä¸ªæ¥å£è¢«æ‰“ä¸Šè¿™ä¸ªæ ‡è®°ï¼Œé‚£ä¹ˆä¼šåœ¨æ¥å£è¢«è¯·æ±‚å®Œæˆåï¼Œä¼šå¼€å§‹æ‰§è¡Œè‡ªå·±ç¼–å†™çš„è½®è¯¢å‡½æ•°ï¼Œæ¥åˆ¤æ–­è¯¥å¼‚æ­¥æ¥å£çš„å¼‚æ­¥ä»»åŠ¡ç»“æœæ˜¯å¦å¾—åˆ°é¢„æœŸç»“æœã€‚
